% This is the test code used for Multi-class SVM
close all;


%% Data initialization/dimension reduction %%

cd('/Users/xiaoweige/Documents/Local Code/EC503-Final-Project/Xiaowei');

%% Data loading
Mat_file = 'mnist.mat';
load(Mat_file);

% %% transpose once from original set
% m = matfile(Mat_file,'Writable',true); % load as handle of .mat
% m.Xtr = Xtr';
% m.Xval = Xval';
% m.Xte = Xte';
% m.ytr = ytr';
% m.yval = yval';
% m.yte = yte';

%% Reshape data trial with 1 sample
i = randi(size(Xtr,1));
figure;     % vis a ramdom sample
imagesc(permute(reshape(Xtr(i,:),28,28), [2 1]));   % permute for display purpose only
axis(gca,'equal','tight');

Xtr_reshaped = permute(reshape(Xtr(i,:),28,28), [2 1]);
Xtr_reshaped_LowDim = imresize(full(Xtr_reshaped),1/2.8);

figure;
imagesc(Xtr_reshaped_LowDim);   
axis(gca,'equal','tight');

%% reshape all dataset and save once
Mat_file = 'mnist_LowDim.mat';


dim_reduce_ratio = 1/2.8;
data_number = size(Xtr,1);
X = full(Xtr);
X_reshaped = reshape(X,data_number,28,28);
X_reshaped_LowDim = imresize(permute(X_reshaped,[2,3,1]),dim_reduce_ratio);
X_LowDim = sparse(reshape(permute(X_reshaped_LowDim,[3,1,2]),data_number,10*10));

